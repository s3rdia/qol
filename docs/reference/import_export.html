<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>High Level Import From And Export To CSV And XLSX — import_export • qol</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="High Level Import From And Export To CSV And XLSX — import_export"><meta name="description" content="import_data(): A wrapper for data.table::fread() and openxlsx2::wb_to_df(),
providing basic import functionality with minimal code.
export_data(): A wrapper for data.table::fwrite() and openxlsx2::wb_save(),
providing basic export functionality with minimal code."><meta property="og:description" content="import_data(): A wrapper for data.table::fread() and openxlsx2::wb_to_df(),
providing basic import functionality with minimal code.
export_data(): A wrapper for data.table::fwrite() and openxlsx2::wb_save(),
providing basic export functionality with minimal code."><meta property="og:image" content="https://s3rdia.github.io/qol/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qol</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/further_compare.html">A Further Comparison Of qol And SAS</a></li>
    <li><a class="dropdown-item" href="../articles/SAS_compare.html">How Does qol Compare to SAS?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/s3rdia/qol/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>High Level Import From And Export To CSV And XLSX</h1>
      <small class="dont-index">Source: <a href="https://github.com/s3rdia/qol/blob/HEAD/R/import_export.R" class="external-link"><code>R/import_export.R</code></a></small>
      <div class="d-none name"><code>import_export.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>import_data()</code>: A wrapper for <code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread()</a></code> and <code><a href="https://janmarvin.github.io/openxlsx2/reference/wb_to_df.html" class="external-link">openxlsx2::wb_to_df()</a></code>,
providing basic import functionality with minimal code.</p>
<p><code>export_data()</code>: A wrapper for <code><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">data.table::fwrite()</a></code> and <code><a href="https://janmarvin.github.io/openxlsx2/reference/wb_save.html" class="external-link">openxlsx2::wb_save()</a></code>,
providing basic export functionality with minimal code.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">import_data</span><span class="op">(</span></span>
<span>  <span class="va">infile</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  region <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separator <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  decimal <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  var_names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">export_data</span><span class="op">(</span></span>
<span>  <span class="va">data_frame</span>,</span>
<span>  <span class="va">outfile</span>,</span>
<span>  separator <span class="op">=</span> <span class="st">";"</span>,</span>
<span>  decimal <span class="op">=</span> <span class="st">","</span>,</span>
<span>  var_names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-infile">infile<a class="anchor" aria-label="anchor" href="#arg-infile"></a></dt>
<dd><p>Full file path with extension to a csv or xlsx file to be imported.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>Only used in xlsx import. Which sheet of the workbook to import.</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>Only used in xlsx import. Can either be an 'Excel' range like 'A1:BY27'
or the name of a named region.</p></dd>


<dt id="arg-separator">separator<a class="anchor" aria-label="anchor" href="#arg-separator"></a></dt>
<dd><p>Only used in CSV-export. Defines the single character value separator.</p></dd>


<dt id="arg-decimal">decimal<a class="anchor" aria-label="anchor" href="#arg-decimal"></a></dt>
<dd><p>Only used in CSV-export. Defines the single character decimal character.</p></dd>


<dt id="arg-var-names">var_names<a class="anchor" aria-label="anchor" href="#arg-var-names"></a></dt>
<dd><p>TRUE by default. Whether to export variable names or not.</p></dd>


<dt id="arg-data-frame">data_frame<a class="anchor" aria-label="anchor" href="#arg-data-frame"></a></dt>
<dd><p>A data frame to export.</p></dd>


<dt id="arg-outfile">outfile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>Full file path with extension. Allowed extensions are ".csv" and ".xlsx".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data frame.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>import_data()</code> and <code>export_data()</code> are based on the 'SAS' procedures Proc Import and Proc Export,
which provide a very straight forward syntax. While 'SAS' can import many different formats with
these procedures, these 'R' versions concentrate on importing CSV and XLSX files.</p>
<p>The main goal here is to just provide as few as possible parameters to tackle most of the imports
and exports. These error handling also tries to let an import and export happen, even though
a parameter wasn't provided in the correct way.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Functions that can export with style: <code><a href="frequencies.html">frequencies()</a></code>, <code><a href="crosstabs.html">crosstabs()</a></code>, <code><a href="any_table.html">any_table()</a></code>,
<code><a href="export_with_style.html">export_with_style()</a></code>.</p>
<p>Creating a custom table style: <code><a href="excel_output_style.html">excel_output_style()</a></code>, <code><a href="modify_output_style.html">modify_output_style()</a></code>,
<code><a href="number_format_style.html">number_format_style()</a></code>, <code><a href="modify_number_formats.html">modify_number_formats()</a></code>.</p>
<p>Global style options: <code><a href="style_options.html">set_style_options()</a></code>, <code><a href="style_options.html">set_variable_labels()</a></code>, <code><a href="style_options.html">set_stat_labels()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Example files</span></span>
<span><span class="va">csv_file</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qol_example_data.csv"</span>,  package <span class="op">=</span> <span class="st">"qol"</span><span class="op">)</span></span>
<span><span class="va">xlsx_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qol_example_data.xlsx"</span>, package <span class="op">=</span> <span class="st">"qol"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import: Provide full file path</span></span>
<span><span class="va">my_csv</span>  <span class="op">&lt;-</span> <span class="fu">import_data</span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span></span>
<span><span class="va">my_xlsx</span> <span class="op">&lt;-</span> <span class="fu">import_data</span><span class="op">(</span><span class="va">xlsx_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import specific regions</span></span>
<span><span class="va">range_import</span> <span class="op">&lt;-</span> <span class="fu">import_data</span><span class="op">(</span><span class="va">xlsx_file</span>, region <span class="op">=</span> <span class="st">"B4:H32"</span><span class="op">)</span></span>
<span><span class="va">name_import</span>  <span class="op">&lt;-</span> <span class="fu">import_data</span><span class="op">(</span><span class="va">xlsx_file</span>, region <span class="op">=</span> <span class="st">"test_region"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import from another sheet</span></span>
<span><span class="va">sheet_import</span> <span class="op">&lt;-</span> <span class="fu">import_data</span><span class="op">(</span><span class="va">xlsx_file</span>, sheet <span class="op">=</span> <span class="st">"Sheet 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data frame</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="dummy_data.html">dummy_data</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example export file paths</span></span>
<span><span class="va">export_csv</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="va">export_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export: Provide full file path</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">export_data</span><span class="op">(</span><span class="va">export_csv</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">export_data</span><span class="op">(</span><span class="va">export_xlsx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manual cleanup for example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">export_csv</span>, <span class="va">export_xlsx</span><span class="op">)</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Siebenmorgen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

