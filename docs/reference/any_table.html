<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Any Possible Table — any_table • qol</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Any Possible Table — any_table"><meta name="description" content="any_table() produces any possible descriptive table in 'Excel' format. Any number
of variables can be nested and crossed. The output is an individually styled
'Excel' table, which also receives named ranges, making it easier to read the data back in."><meta property="og:description" content="any_table() produces any possible descriptive table in 'Excel' format. Any number
of variables can be nested and crossed. The output is an individually styled
'Excel' table, which also receives named ranges, making it easier to read the data back in."><meta property="og:image" content="https://s3rdia.github.io/qol/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qol</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/further_compare.html">A Further Comparison Of qol And SAS</a></li>
    <li><a class="dropdown-item" href="../articles/SAS_compare.html">How Does qol Compare to SAS?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/s3rdia/qol/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Any Possible Table</h1>
      <small class="dont-index">Source: <a href="https://github.com/s3rdia/qol/blob/HEAD/R/any_table.R" class="external-link"><code>R/any_table.R</code></a></small>
      <div class="d-none name"><code>any_table.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>any_table()</code> produces any possible descriptive table in 'Excel' format. Any number
of variables can be nested and crossed. The output is an individually styled
'Excel' table, which also receives named ranges, making it easier to read the data back in.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">any_table</span><span class="op">(</span></span>
<span>  <span class="va">data_frame</span>,</span>
<span>  <span class="va">rows</span>,</span>
<span>  columns <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">values</span>,</span>
<span>  statistics <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  pct_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pct_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order_by <span class="op">=</span> <span class="st">"stats"</span>,</span>
<span>  titles <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"titles"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  footnotes <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"footnotes"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  var_labels <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"var_labels"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  stat_labels <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"stat_labels"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  box <span class="op">=</span> <span class="st">""</span>,</span>
<span>  workbook <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"excel_style"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  output <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"output"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  print_miss <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"print_miss"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  print <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"print"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  monitor <span class="op">=</span> <span class="va">.qol_options</span><span class="op">[[</span><span class="st">"monitor"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-frame">data_frame<a class="anchor" aria-label="anchor" href="#arg-data-frame"></a></dt>
<dd><p>A data frame in which are the variables to tabulate.</p></dd>


<dt id="arg-rows">rows<a class="anchor" aria-label="anchor" href="#arg-rows"></a></dt>
<dd><p>A vector that provides single variables or variable combinations that
should appear in the table rows. To nest variables use the form:
"var1 + var2 + var3 + ...".</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>A vector that provides single variables or variable combinations that
should appear in the table rows. To nest variables use the form:
"var1 + var2 + var3 + ...".</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>A vector containing all variables that should be summarised.</p></dd>


<dt id="arg-statistics">statistics<a class="anchor" aria-label="anchor" href="#arg-statistics"></a></dt>
<dd><p>Available functions:</p><ul><li><p>"sum"       -&gt; Weighted and unweighted sum</p></li>
<li><p>"sum_wgt"   -&gt; Sum of all weights</p></li>
<li><p>"freq"      -&gt; Unweighted frequency</p></li>
<li><p>"freq_g0"   -&gt; Unweighted frequency of all values greater than zero</p></li>
<li><p>"pct_group" -&gt; Weighted and unweighted percentages within the respective group</p></li>
<li><p>"pct_value" -&gt; Weighted and unweighted percentages between value variables</p></li>
<li><p>"pct_total" -&gt; Weighted and unweighted percentages compared to the grand total</p></li>
<li><p>"mean"      -&gt; Weighted and unweighted mean</p></li>
<li><p>"median"    -&gt; Weighted and unweighted median</p></li>
<li><p>"mode"      -&gt; Weighted and unweighted mode</p></li>
<li><p>"min"       -&gt; Minimum</p></li>
<li><p>"max"       -&gt; Maximum</p></li>
<li><p>"sd"        -&gt; Weighted and unweighted standard deviation</p></li>
<li><p>"variance"  -&gt; Weighted and unweighted standard variance</p></li>
<li><p>"first"     -&gt; First value</p></li>
<li><p>"last"      -&gt; Last value</p></li>
<li><p>"pn"        -&gt; Weighted and unweighted percentiles (any p1, p2, p3, ... possible)</p></li>
<li><p>"missing"   -&gt; Missings generated by the value variables</p></li>
</ul></dd>


<dt id="arg-pct-group">pct_group<a class="anchor" aria-label="anchor" href="#arg-pct-group"></a></dt>
<dd><p>If pct_group is specified in the statistics, this option is used to
determine which variable of the row and column variables should add up to 100 %.
Multiple variables can be specified in a vector to generate multiple group percentages.</p></dd>


<dt id="arg-pct-value">pct_value<a class="anchor" aria-label="anchor" href="#arg-pct-value"></a></dt>
<dd><p>If pct_value is specified in the statistics, you can pass a list here
which contains the information for a new variable name and between which of the value
variables percentages should be computed.</p></dd>


<dt id="arg-formats">formats<a class="anchor" aria-label="anchor" href="#arg-formats"></a></dt>
<dd><p>A list in which is specified which formats should be applied to which variables.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Compute tables stratified by the expressions of the provided variables.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>Put in a weight variable to compute weighted results.</p></dd>


<dt id="arg-order-by">order_by<a class="anchor" aria-label="anchor" href="#arg-order-by"></a></dt>
<dd><p>Determine how the columns will be ordered. "values" orders the results by the
order you provide the variables in values. "stats" orders them by the order under statistics.
"values_stats" is a combination of both. "columns" keeps the order as given in columns
and "interleaved" alternates the stats.</p></dd>


<dt id="arg-titles">titles<a class="anchor" aria-label="anchor" href="#arg-titles"></a></dt>
<dd><p>Specify one or more table titles.</p></dd>


<dt id="arg-footnotes">footnotes<a class="anchor" aria-label="anchor" href="#arg-footnotes"></a></dt>
<dd><p>Specify one or more table footnotes.</p></dd>


<dt id="arg-var-labels">var_labels<a class="anchor" aria-label="anchor" href="#arg-var-labels"></a></dt>
<dd><p>A list in which is specified which label should be printed for
which variable instead of the variable name.</p></dd>


<dt id="arg-stat-labels">stat_labels<a class="anchor" aria-label="anchor" href="#arg-stat-labels"></a></dt>
<dd><p>A list in which is specified which label should be printed for
which statistic instead of the statistic name.</p></dd>


<dt id="arg-box">box<a class="anchor" aria-label="anchor" href="#arg-box"></a></dt>
<dd><p>Provide a text for the upper left box of the table.</p></dd>


<dt id="arg-workbook">workbook<a class="anchor" aria-label="anchor" href="#arg-workbook"></a></dt>
<dd><p>Insert a previously created workbook to expand the sheets instead of
creating a new file.</p></dd>


<dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>A list of options can be passed to control the appearance of 'Excel' outputs.
Styles can be created with <code><a href="excel_output_style.html">excel_output_style()</a></code>.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>The following output formats are available: excel and excel_nostyle.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>FALSE by default. If TRUE removes all NA values from the variables.</p></dd>


<dt id="arg-print-miss">print_miss<a class="anchor" aria-label="anchor" href="#arg-print-miss"></a></dt>
<dd><p>FALSE by default. If TRUE outputs all possible categories of the
grouping variables based on the provided formats, even if there are no observations
for a combination.</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>TRUE by default. If TRUE prints the output, if FALSE doesn't print anything. Can be used
if one only wants to catch the output data frame and workbook with meta information.</p></dd>


<dt id="arg-monitor">monitor<a class="anchor" aria-label="anchor" href="#arg-monitor"></a></dt>
<dd><p>FALSE by default. If TRUE, outputs two charts to visualize the functions time consumption.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with the data table containing the results for the table, the formatted
'Excel' workbook and the meta information needed for styling the final table.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>any_table()</code> is based on the 'SAS' procedure Proc Tabulate, which provides
efficient and readable ways to perform complex tabulations.</p>
<p>With this function you can combine any number of variables in any possible way, all
at once. You just define which variables or variable combinations should end up in
the table rows and columns with a simple syntax. Listing variables in a vector like
c("var1", "var2", "var3",...) means to put variables below (in case of the
row variables) or besides (in case of the column variables) each other. Nesting variables
is as easy as putting a plus sign between them, e.g. c("var1 + var2", "var2" + "var3" + "var4", etc.).
And of course you can combine both versions.</p>
<p>The real highlight is, that this function not only creates all the desired variable
combinations and exports them to an 'Excel' file, it prints a fully custom styled
table to a workbook. Setting up a custom, reusable style is as easy as setting up
options like: provide a color for the table header, set the font size for the row header,
should borders be drawn for the table cells yes/no, and so on. Merging doubled header texts,
happens automatically.</p>
<p>With this function you basically can fully concentrate on designing a table, instead of
thinking hard about how to calculate where to put a border or to even manually prepare
a designed workbook.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Creating a custom table style: <code><a href="excel_output_style.html">excel_output_style()</a></code>, <code><a href="modify_output_style.html">modify_output_style()</a></code>,
<code><a href="number_format_style.html">number_format_style()</a></code>, <code><a href="modify_number_formats.html">modify_number_formats()</a></code>.</p>
<p>Global style options: <code><a href="style_options.html">set_style_options()</a></code>, <code><a href="style_options.html">set_variable_labels()</a></code>, <code><a href="style_options.html">set_stat_labels()</a></code>.</p>
<p>Creating formats: <code><a href="formats.html">discrete_format()</a></code> and <code><a href="formats.html">interval_format()</a></code>.</p>
<p>Functions that can handle formats and styles: <code><a href="frequencies.html">frequencies()</a></code>, <code><a href="crosstabs.html">crosstabs()</a></code>.</p>
<p>Additional functions that can handle styles: <code><a href="export_with_style.html">export_with_style()</a></code></p>
<p>Additional functions that can handle formats: <code><a href="summarise_plus.html">summarise_plus()</a></code>, <code><a href="recode.html">recode()</a></code>,
<code><a href="recode.html">recode_multi()</a></code>, <code><a href="transpose_plus.html">transpose_plus()</a></code>, <code><a href="sort_plus.html">sort_plus()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Example data frame</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="dummy_data.html">dummy_data</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">my_data</span><span class="op">[[</span><span class="st">"person"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Formats</span></span>
<span><span class="va">age.</span> <span class="op">&lt;-</span> <span class="fu"><a href="formats.html">discrete_format</a></span><span class="op">(</span></span>
<span>    <span class="st">"Total"</span>          <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>    <span class="st">"under 18"</span>       <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">17</span>,</span>
<span>    <span class="st">"18 to under 25"</span> <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">24</span>,</span>
<span>    <span class="st">"25 to under 55"</span> <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">54</span>,</span>
<span>    <span class="st">"55 to under 65"</span> <span class="op">=</span> <span class="fl">55</span><span class="op">:</span><span class="fl">64</span>,</span>
<span>    <span class="st">"65 and older"</span>   <span class="op">=</span> <span class="fl">65</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sex.</span> <span class="op">&lt;-</span> <span class="fu"><a href="formats.html">discrete_format</a></span><span class="op">(</span></span>
<span>    <span class="st">"Total"</span>  <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>    <span class="st">"Male"</span>   <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"Female"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">education.</span> <span class="op">&lt;-</span> <span class="fu"><a href="formats.html">discrete_format</a></span><span class="op">(</span></span>
<span>    <span class="st">"Total"</span>            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"middle"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span>    <span class="st">"low education"</span>    <span class="op">=</span> <span class="st">"low"</span>,</span>
<span>    <span class="st">"middle education"</span> <span class="op">=</span> <span class="st">"middle"</span>,</span>
<span>    <span class="st">"high education"</span>   <span class="op">=</span> <span class="st">"high"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">state.</span> <span class="op">&lt;-</span> <span class="fu"><a href="formats.html">discrete_format</a></span><span class="op">(</span></span>
<span>    <span class="st">"Germany"</span>                       <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span>,</span>
<span>    <span class="st">"Schleswig-Holstein"</span>            <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"Hamburg"</span>                       <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="st">"Lower Saxony"</span>                  <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    <span class="st">"Bremen"</span>                        <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    <span class="st">"North Rhine-Westphalia"</span>        <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"Hesse"</span>                         <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"Rhineland-Palatinate"</span>          <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    <span class="st">"Baden-Württemberg"</span>             <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    <span class="st">"Bavaria"</span>                       <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    <span class="st">"Saarland"</span>                      <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    <span class="st">"West"</span>                          <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>    <span class="st">"Berlin"</span>                        <span class="op">=</span> <span class="fl">11</span>,</span>
<span>    <span class="st">"Brandenburg"</span>                   <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    <span class="st">"Mecklenburg-Western Pomerania"</span> <span class="op">=</span> <span class="fl">13</span>,</span>
<span>    <span class="st">"Saxony"</span>                        <span class="op">=</span> <span class="fl">14</span>,</span>
<span>    <span class="st">"Saxony-Anhalt"</span>                 <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    <span class="st">"Thuringia"</span>                     <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    <span class="st">"East"</span>                          <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define style</span></span>
<span><span class="fu"><a href="style_options.html">set_style_options</a></span><span class="op">(</span>column_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define titles and footnotes. If you want to add hyperlinks you can do so by</span></span>
<span><span class="co"># adding "link:" followed by the hyperlink to the main text.</span></span>
<span><span class="fu"><a href="qol_options.html">set_titles</a></span><span class="op">(</span><span class="st">"This is title number 1 link: https://cran.r-project.org/"</span>,</span>
<span>           <span class="st">"This is title number 2"</span>,</span>
<span>           <span class="st">"This is title number 3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="qol_options.html">set_footnotes</a></span><span class="op">(</span><span class="st">"This is footnote number 1"</span>,</span>
<span>              <span class="st">"This is footnote number 2"</span>,</span>
<span>              <span class="st">"This is footnote number 3 link: https://cran.r-project.org/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output complex tables with different percentages</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex + age"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"education + year"</span><span class="op">)</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"pct_group"</span><span class="op">)</span>,</span>
<span>                     pct_group  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span>,</span>
<span>                                       education <span class="op">=</span> <span class="va">education.</span><span class="op">)</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If you want to get a clearer vision of what the result table looks like, in terms</span></span>
<span><span class="co"># of the row and column categories, you can write the code like this, to make out</span></span>
<span><span class="co"># the variable crossings and see the order.</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>            <span class="st">"year"</span>, <span class="st">"education + year"</span><span class="op">)</span>,</span>
<span>                     rows    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex + age"</span>,</span>
<span>                                 <span class="st">"sex"</span>,</span>
<span>                                 <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"pct_group"</span><span class="op">)</span>,</span>
<span>                     pct_group  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span>,</span>
<span>                                       education <span class="op">=</span> <span class="va">education.</span><span class="op">)</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Percentages based on value variables instead of categories</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age + year"</span><span class="op">)</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">probability</span>, <span class="va">person</span><span class="op">)</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pct_value"</span>, <span class="st">"sum"</span>, <span class="st">"freq"</span><span class="op">)</span>,</span>
<span>                     pct_value  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="st">"probability / person"</span><span class="op">)</span>,</span>
<span>                     weight     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span><span class="op">)</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Customize the visual appearance by adding variable and statistic labels. Both</span></span>
<span><span class="co"># can also be set as a global option, if labels should be reused over multiple</span></span>
<span><span class="co"># tables.</span></span>
<span><span class="co"># Note: You don't have to describe every element. Sometimes a table can be more</span></span>
<span><span class="co"># readable with less text. To completely remove a variable label just put in an</span></span>
<span><span class="co"># empty text "" as label.</span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age + year"</span><span class="op">)</span>,</span>
<span>                     columns     <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                     values      <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     statistics  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"pct_group"</span><span class="op">)</span>,</span>
<span>                     order_by    <span class="op">=</span> <span class="st">"interleaved"</span>,</span>
<span>                     formats     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span><span class="op">)</span>,</span>
<span>                     var_labels  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="st">"Age categories"</span>,</span>
<span>                                        sex <span class="op">=</span> <span class="st">""</span>, weight <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>                     stat_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pct <span class="op">=</span> <span class="st">"%"</span><span class="op">)</span>,</span>
<span>                     na.rm       <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Individual styling can also be passed directly</span></span>
<span><span class="va">my_style</span> <span class="op">&lt;-</span> <span class="fu"><a href="excel_output_style.html">excel_output_style</a></span><span class="op">(</span>header_back_color <span class="op">=</span> <span class="st">"0077B6"</span>,</span>
<span>                               font              <span class="op">=</span> <span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age + year"</span><span class="op">)</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">probability</span>, <span class="va">person</span><span class="op">)</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pct_value"</span>, <span class="st">"sum"</span>, <span class="st">"freq"</span><span class="op">)</span>,</span>
<span>                     pct_value  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="st">"probability / person"</span><span class="op">)</span>,</span>
<span>                     weight     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span><span class="op">)</span>,</span>
<span>                     style      <span class="op">=</span> <span class="va">my_style</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pass on workbook to create more sheets in the same file</span></span>
<span><span class="va">my_style</span> <span class="op">&lt;-</span> <span class="va">my_style</span> <span class="op">|&gt;</span> <span class="fu"><a href="modify_output_style.html">modify_output_style</a></span><span class="op">(</span>sheet_name <span class="op">=</span> <span class="st">"age_sex"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op">|&gt;</span></span>
<span>           <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span><span class="op">)</span>,</span>
<span>                     style      <span class="op">=</span> <span class="va">my_style</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     print      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_style</span> <span class="op">&lt;-</span> <span class="va">my_style</span> <span class="op">|&gt;</span> <span class="fu"><a href="modify_output_style.html">modify_output_style</a></span><span class="op">(</span>sheet_name <span class="op">=</span> <span class="st">"edu_year"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>workbook   <span class="op">=</span> <span class="va">result_list</span><span class="op">[[</span><span class="st">"workbook"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                     rows       <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="st">"pct_group"</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>education <span class="op">=</span> <span class="va">education.</span><span class="op">)</span>,</span>
<span>                     style      <span class="op">=</span> <span class="va">my_style</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The result list from above also carries the transformed data frame if</span></span>
<span><span class="co"># needed for further usage</span></span>
<span><span class="va">any_table_df</span> <span class="op">&lt;-</span> <span class="va">result_list</span><span class="op">[[</span><span class="st">"table"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Output multiple complex tables by expressions of another variable.</span></span>
<span><span class="co"># If you specify the sheet name as "by" in the output style, the sheet</span></span>
<span><span class="co"># names are named by the variable expressions of the by-variable. Otherwise</span></span>
<span><span class="co"># the given sheet named gets a running number.</span></span>
<span><span class="va">my_style</span> <span class="op">&lt;-</span> <span class="va">my_style</span> <span class="op">|&gt;</span> <span class="fu"><a href="modify_output_style.html">modify_output_style</a></span><span class="op">(</span>sheet_name <span class="op">=</span> <span class="st">"by"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"education + year"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     by         <span class="op">=</span> <span class="va">state</span>,</span>
<span>                     statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"pct_group"</span><span class="op">)</span>,</span>
<span>                     pct_group  <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span>, age <span class="op">=</span> <span class="va">age.</span>, state <span class="op">=</span> <span class="va">state.</span>,</span>
<span>                                       education <span class="op">=</span> <span class="va">education.</span><span class="op">)</span>,</span>
<span>                     na.rm      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To save a table as xlsx file you have to set the path and filename in the</span></span>
<span><span class="co"># style element</span></span>
<span><span class="co"># Example files paths</span></span>
<span><span class="va">table_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note: Normally you would directly input the path ("C:/MyPath/") and name ("MyFile.xlsx").</span></span>
<span><span class="fu"><a href="style_options.html">set_style_options</a></span><span class="op">(</span>save_path  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">table_file</span><span class="op">)</span>,</span>
<span>                  file       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">table_file</span><span class="op">)</span>,</span>
<span>                  sheet_name <span class="op">=</span> <span class="st">"MyTable"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">|&gt;</span> <span class="fu">any_table</span><span class="op">(</span>rows       <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                     columns    <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                     values     <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                     formats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="va">sex.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manual cleanup for example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">table_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Global options are permanently active until the current R session is closed.</span></span>
<span><span class="co"># There are also functions to reset the values manually.</span></span>
<span><span class="fu"><a href="style_options.html">reset_style_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="style_options.html">reset_qol_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="style_options.html">close_file</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Siebenmorgen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

